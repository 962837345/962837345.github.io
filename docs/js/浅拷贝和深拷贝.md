---
title: 浅拷贝和深拷贝
date: 2020-07-28
tags:
 - JS
categories:
 - 前端笔记
---

## 浅拷贝
浅拷贝只是拷贝一层，更深层次对象级别的只拷贝引用

示例：
```js
var obj = {
  id: 1,
  name: 'kellen',
  msg:{
    age:20
  }
};
var o = {};
for(var k in obj){
  o[k] = obj[k]
}
console.log(o);
o.msg.age = 22;
console.log(obj);
```
输出：
```
{id: 1, name: "kellen", msg: {…}}
id: 1
msg: {age: 22}
name: "kellen"

{id: 1, name: "kellen", msg: {…}}
id: 1
msg: {age: 22}
name: "kellen"
```
可见浅拷贝拷贝出来的对象中更深一层对象与被拷贝对象指向同一个地址

:::tip
ES6中可以使用Object.assign(target,...sources)实现浅拷贝
:::

## 深拷贝
深拷贝拷贝多层，每一级别的数据都会拷贝

```js
var obj = {
  id: 1,
  name: 'kellen',
  msg:{
    age:20
  }
};
var o = {};
function deepCopy(newObj, oldObj) {
  for(var k in oldObj){
    // 1.获取属性值
    var item = oldObj[k];
    // 2.判断整个值是否是数组
    if(item instanceof Array){
      newObj[k] = [];
      deepCopy(newObj[k], item)
    }else if(item instanceof Object){
      // 3. 判断整个值是否是对象
      newObj[k] = {}
      deepCopy(newObj[k], item)
    }else {
      // 4. 属于简单数据类型
      newObj[k] = item;
    }
  }
}
deepCopy(o, obj);
console.log(o);
o.msg.age = 22;
console.log(obj);
```
输出：
```
Object
id: 1
msg: {age: 22}
name: "kellen"

Object
id: 1
msg: {age: 20}
name: "kellen"
```
可见已完成了深拷贝,msg指向不同的地址
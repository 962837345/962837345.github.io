---
title: JS中的栈和堆
date: 2020-07-24
tags:
 - JS
categories:
 - 前端笔记
---

## 栈和堆
栈(stack)：栈会自动分配内存空间，会自动释放，存放基本类型，简单的数据段，占据固定大小的空间。

基本类型：String，Number，Boolean，Null，Undefined

堆(heap):动态分配的内存，大小不定也不会自动释放，存放引用类型，指那些可能由多个值构成的对象，保存在堆内存中，包含引用类型的变量，实际上保存的不是变量本身，而是指向该对象的指针。

引用类型：Function，Array，Object

## 垃圾回收

```js
var obj = new Object();
obj = null;
```
创建一个obj对象，对象会在堆内存中创建一个空间存储，栈内存中的key为obj的value会指向堆内存中的该空间

当我们将obj赋值为null时，此时指向堆内存的链接就被断开了，此时堆内存中的那片空间就无法找到了，此时那片空间就是垃圾

在JS中拥有自动的垃圾回收机制，会自动将这样的垃圾对象从内存中销毁

当我们需要进行垃圾回收时，只需要使一个对象赋值为null就行

## 代码例子
### 示例1：
```js
let a = {};
b = '0';
c = 0;
a[b] = '哈哈';
a[c] = '嘿嘿';
console.log(a[b]);
```
输出：`嘿嘿`

解析：属性名不能重复，数字属性名==字符串属性名，所以后面的'嘿嘿’会覆盖前面的'哈哈'，因为key是一样的

### 示例2：
```js
let a = {};
b = Symbol('1');
c = Symbol('1');
a[b] = '哈哈';
a[c] = '嘿嘿';
console.log(a[b])
```
输出：`哈哈`

解析：Symbol创建是唯一值的,所以b和c不相等，所以输出`哈哈`

### 示例3
```js
let a = {};
b = {
  n: '1'
};
c = {
  m: '2'
};
a[b] = '哈哈';
a[c] = '嘿嘿';
console.log(a[b]);
```
输出：`嘿嘿`

解析：引用类型的都会转换成字符串，无论{ }里面的内容是什么，都会被转换成Object object，所以两次key相同，覆盖，输出`嘿嘿`
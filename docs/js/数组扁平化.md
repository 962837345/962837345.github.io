---
title: 数组扁平化
date: 2020-11-24
tags:
 - JS
categories:
 - 前端笔记
---

数组扁平化就是将多维数组转化为一维数组

## 使用reduce实现

```js
const arr = [1, 2, [3, 4, [5, 6]]];
function flatten(arr) {
    return arr.reduce((result, item) => {
        return result.concat(Array.isArray(item) ? flatten(item) : item);
    }, []);
}
console.log(flatten(arr)); // [1, 2, 3, 4, 5, 6]
```

## 使用`toString`和`split`

```js
const arr = [1, 2, [3, 4, [5, 6]]];
/*
 * toString()会将数组变成用逗号分隔开的字符串
 * 通过split可以字符串分割还原成数组
 * 由于split形成的数组每一项值为字符串类型，所以使用map将里面每一项都转为数值
 */
function flatten(arr) {
    return arr.toString().split(',').map(item => Number(item))
}
console.log(flatten(arr)); // [1, 2, 3, 4, 5, 6]
```

## 使用`join`和`split`

```js
const arr = [1, 2, [3, 4, [5, 6]]];
/*
 * 原理同上，join效果与toString效果一样
 */
function flatten(arr) {
    return arr.join(',').split(',').map(item => Number(item));
}
console.log(flatten(arr)); // [1, 2, 3, 4, 5, 6]
```

## 递归循环

```js
const arr = [1, 2, [3, 4, [5, 6]]];
function flatten(arr) {
    let newArr = [];
    arr.map((item) => {
        if (Array.isArray(item)) {
            newArr = newArr.concat(flatten(item));
        } else {
            newArr.push(item);
        }
    });
    return newArr;
}
console.log(flatten(arr)); // [1, 2, 3, 4, 5, 6]
```

## 扩展运算符降维

扩展运算符可以每次使数组降低一个维度

```js
let arr = [1, 2, [3, 4, [5, 6]]];
function flatten(arr) {
    while (arr.some((item) => Array.isArray(item))) {
        arr = [].concat(...arr);
    }
    return arr;
}
console.log(flatten(arr)); // [1, 2, 3, 4, 5, 6]
```

## 使用数组实例的flat()方法

`Array.prototype.flat()`用于将嵌套的数组进行扁平化处理。该方法返回一个新数组，对原数据没有影响。

```js
[1, 2, [3, 4]].flat() // [1, 2, 3, 4]
```

`flat()`默认只会“拉平”一层，如果想要“拉平”多层的嵌套数组，可以将`flat()`方法的参数写成一个整数，表示想要拉平的层数，默认为1

```js
const arr = [1,2,[3,4,[5,6]]]
arr.flat(2) // [1, 2, 3, 4, 5, 6]
```

如果不管有多少层嵌套，都要转成一维数组，可以用`infinity`关键字作为参数

```js
[1, [2, [3]]].flat(Infinity) // [1, 2, 3]
```

